        -:    0:Source:funcs.cpp
        -:    0:Graph:funcs.gcno
        -:    0:Data:funcs.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:/*
        -:    2:*  funcs.cpp
        -:    3:*  Lab2
        -:    4:*
        -:    5:*  Created by Lukas Ferreira on 14/09/16.
        -:    6:*  Copyright © 2016 Lukas Ferreira. All rights reserved.
        -:    7:*/
        -:    8:
        -:    9:#include "funcs.hpp"
        -:   10:using namespace Add;
        -:   11:
        -:   12:/* Descrição:
        -:   13: Retorna o numero decimal de acordo com o caracter romano
        -:   14: Parâmetros:
        -:   15: roman - char romano a ser convertido para decimal
        -:   16: Retorno:
        -:   17: int - decimal do numero romano
        -:   18: */
        -:   19:
        -:   20:int Addition::value(char roman)
        -:   21:{
      809:   22:    switch(roman)
        -:   23:    {
       83:   24:        case 'I':return 1;
       22:   25:        case 'V':return 5;
      206:   26:        case 'X':return 10;
       44:   27:        case 'L':return 50;
      180:   28:        case 'C':return 100;
       39:   29:        case 'D':return 500;
      129:   30:        case 'M':return 1000;
       30:   31:        case 'i':return 1;
    #####:   32:        case 'v':return 5;
       15:   33:        case 'x':return 10;
        7:   34:        case 'l':return 50;
       15:   35:        case 'c':return 100;
    #####:   36:        case 'd':return 500;
       21:   37:        case 'm':return 1000;
        -:   38:            
       18:   39:        default: return 0;  /* Se o caracter nao for valido */
        -:   40:    }
      809:   41:}
        -:   42:
        -:   43:/* Descrição:
        -:   44: Converte um numero romano para decimal
        -:   45: Parâmetros:
        -:   46: input - referencia para a string do numero romano
        -:   47: Retorno:
        -:   48: int - numero romano em sua forma decimal
        -:   49: */
        -:   50:
        -:   51:int Addition::from_roman(const string& input)
        -:   52:{
       31:   53:    int sum = 0;
       31:   54:    int count = 1;
       31:   55:    char prev = input[input.length() - 1];
        -:   56:    char aux;
       31:   57:    string result = "";
       31:   58:    string result_prev = "";
        -:   59:    
      118:   60:    if ((value(prev) < 1) || ((input.length() - 1) > 30) || ((input.length() - 1) < 1)) {
        3:   61:        return -1;
        -:   62:    }
        -:   63:    
      238:   64:    for(int i = int((input.length() - 2)); i >= 0; i--)
        -:   65:    {
        -:   66:        /* Caracter Invalido */
        -:   67:        
      216:   68:        if (value(prev) < 1)
        -:   69:        {
    #####:   70:            return  -1;
        -:   71:        }
        -:   72:        
      216:   73:        if (prev == input[i])
        -:   74:        {
       29:   75:            count++;
       29:   76:        } else {
       79:   77:            count = 1;
        -:   78:        }
        -:   79:        
      951:   80:        if ((toupper(input[i]) == 'V' || toupper(input[i]) == 'L' || toupper(input[i]) == 'D') && count > 1)
        -:   81:        {
        4:   82:            return -1;
        -:   83:        }
        -:   84:        
      949:   85:        if ((toupper(input[i]) == 'I' || toupper(input[i]) == 'X' || toupper(input[i]) == 'C' || toupper(input[i]) == 'M') && count > 3)
        -:   86:        {
        2:   87:            return -1;
        -:   88:        }
        -:   89:        /* Verifica com o auxilio de it_contains se
        -:   90:         a sequencia de numeros romanos desejada existe
        -:   91:         */
      408:   92:        if(value(input[i]) < value(prev)) {
      114:   93:            aux = toupper(input[i]);
       38:   94:            result += aux;
       76:   95:            result += toupper(prev);
       38:   96:            result_prev = result;
      152:   97:            if (((it_contains(result)) == false)) {
        4:   98:                return -1;
        -:   99:            }
       34:  100:            result = "";
       34:  101:        }
        -:  102:        /* Verifica se a sequencia de numeros romanos e do tipo
        -:  103:         CM, CD, XC, XL, IX, IV ou se e outro qualquer numero romano.
        -:  104:         
        -:  105:         No primeiro caso, subtraimos o segundo numero romano do primeiro, ou seja,
        -:  106:         M - C = 900
        -:  107:         D - C = 400
        -:  108:         C - X = 90
        -:  109:         L - X = 40
        -:  110:         X - I = 9
        -:  111:         V - I = 4
        -:  112:         
        -:  113:         No segundo caso, apenas somamos o numero romano na soma total dado por sum
        -:  114:         */
      460:  115:        if((value(input[i]) < value(prev)) && (input[i] != prev)) {
      136:  116:            sum += (value(prev) - value(input[i]));
       68:  117:            prev = input[i];
       34:  118:        } else {
       64:  119:            if (i == int((input.length() - 2))) {
       20:  120:                sum += value(prev) + value(input[i]);
      330:  121:            } else if ((value(input[i - 1]) < value(input[i])) && ((i - 1) >= 0)) {
       19:  122:                sum += 0;
       19:  123:            } else {
      120:  124:                sum += value(input[i]);
        -:  125:            }
      128:  126:            prev = input[i];
        -:  127:        }
        -:  128:        
      592:  129:        if ((it_contains(result_prev) == true) && value(input[i - 1]) < sum) {
        7:  130:            return -1;
        -:  131:        }
       91:  132:        result_prev = "";
       91:  133:    }
        -:  134:    /* Retorna -1 se a soma for maior que 3000, a soma do contrario */
       33:  135:    return (sum > 3000 ? -1 : sum);
       62:  136:}
        -:  137:
        -:  138:/* Descrição:
        -:  139: Verifica se o numero romano e 900 ou 400 ou 90 ou 9 ou 4
        -:  140: Parâmetros:
        -:  141: input - numero romano a ser verificado
        -:  142: Retorno:
        -:  143: True se o numero romano existir, False do contrario
        -:  144: */
        -:  145:
        -:  146:bool Addition::it_contains (string input)
        -:  147:{
      146:  148:    string result;
        -:  149:    struct romandata_t { int value; char const* numeral; };
        -:  150:    /* Look-up table para os numeros validos */
        -:  151:    static romandata_t const romandata[] = {
        -:  152:        {900, "CM"},
        -:  153:        {400, "CD"},
        -:  154:        {90, "XC"},
        -:  155:        {40, "XL"},
        -:  156:        {9, "IX"},
        -:  157:        {4, "IV"},
        -:  158:        {900, "cm"},
        -:  159:        {400, "cd"},
        -:  160:        {90, "xc"},
        -:  161:        {40, "xl"},
        -:  162:        {9, "ix"},
        -:  163:        {4, "iv"},
        -:  164:        {0, NULL} };
        -:  165:
     2376:  166:    for (romandata_t const* current = romandata; current->numeral != NULL; ++current)
        -:  167:    {
        -:  168:        
     1117:  169:        if (input == current->numeral)
        -:  170:        {
       75:  171:            return true;
        -:  172:        }
     1042:  173:    }
        -:  174:
       71:  175:    return false;
      146:  176:}
        -:  177:
        -:  178:/* Descrição:
        -:  179: Converte um numero decimal para romano
        -:  180: Parâmetros:
        -:  181: value - inteiro a ser convertido para romano
        -:  182: Retorno:
        -:  183: string - numero decimal em sua forma romana 
        -:  184: */
        -:  185:
        -:  186:string Addition::to_roman(int value)
        -:  187:{
        -:  188:    struct romandata_t { int value; char const* numeral; };
        -:  189:    /* Look-up table para os numeros validos */
        -:  190:    static romandata_t const romandata[] = {
        -:  191:        {1000, "M"},
        -:  192:        {900, "CM"},
        -:  193:        {500, "D"},
        -:  194:        {400, "CD"},
        -:  195:        {100, "C"},
        -:  196:        {90, "XC"},
        -:  197:        {50, "L"},
        -:  198:        {40, "XL"},
        -:  199:        {10, "X"},
        -:  200:        {9, "IX"},
        -:  201:        {5, "V"},
        -:  202:        {4, "IV"},
        -:  203:        {1, "I"},
        -:  204:        {0, NULL} };
        4:  205:    string result;
        -:  206:    
      112:  207:    for (romandata_t const* current = romandata; current->value > 0; ++current)
        -:  208:    {
      142:  209:        while (value >= current->value)
        -:  210:        {
       19:  211:            result += current->numeral;
       19:  212:            value  -= current->value;
        -:  213:        }
       52:  214:    }
        4:  215:    return result;
        8:  216:}
